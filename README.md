


# zigbee-time

## 总体进度安排

| 时间                 | 任务                                   | 完成度 |
| :-------------       |:-------------                          |:-----  |
| 2016/11-2016-12      | zibee路由协议的论文查看和算法成果研究  | 作废    |
| -                    | 门锁程序和基站程序的设计(前期先进行实验数据的获取,不实现应用部分)   |   80%  |
| -                    | express和tcp编写                    |    80%  |
| 2016/12-2017/01      | 设计zigbee路由算法  | 作废    |
| -                    | 实现门锁离线程序,基站和pc通信程序   |  100%  |
| -                    | 实现总通信协议                      |    10%  |
| 2016/01-2017/03      | 实现总体设计  | 70%     |
| -                    | 编写论文  |   95%  |

## 日进度

| 时间          | 类型           | 进度    |
|:------------- |:-------------  |:-----   |
| 2016/10/31    | zigbee-http    | socket.io成功 |
| 2016/11/01    | zigbee-http    | 添加mongodb配置 |
| 2016/11/02    | zigbee-http    | 添加redis配置 |
| 2016/11/03    | zigbee-http    | 添加登录功能 |
| 2016/11/04    | zigbee-tcp     | 添加进程和错误日志,开启多进程,添加守护进程,添加tcp服务 |
| 2016/11/05    | zigbee-tcp     | 添加tcp服务日志,模拟socket连接成功 |
| 2016/11/06    | zigbee-tcp     | socket连接状态通过redis发布成功 |
|               | zigbee-http    | 成功订阅tcp服务的socket连接状态  |
| 2016/11/07    | zigbee-http    | redis订阅数据成功通过socket.io发送至浏览器 |
|               | zigbee-tcp     | 增加基站数据字段,至此,tcp -> redis -> http -> browser路线走通  |
| 2016/11/08    | zigbee-http    | 添加图表曲线插件,引入angular |
|               | zigbee-tcp     | 连接真实设备两台成功  |
| 2016/11/09    | zigbee-http    | zigbee路由协议研究,决定使用RSSI作为路由算法的主参数 |
| 2016/11/10    | zigbee-lock    | IAR环境的配置,zigbee嗅探器工具的使用 |
| 2016/11/11    | zigbee-lock    | sysclk,led,pcf8563等驱动层和外设层的程序编写和测试,使用PM2休眠一秒钟并唤醒,增加射频模块 |
| 2016/11/17    | zigbee-lock    | ad检测和定时器模块和测试，他人论文的查看，研究了Leach路由算法，但是并不是zigbee协议的路由，重新考虑论文的侧重点 |   
| 2016/11/22    | zigbee-lock    | zigbee方面的论文查看，zigbee协议栈的研究，论文侧重点定论为z-stack协议栈的研究以及RFID读卡器的研究，低功耗仍然作为侧重点，加入zigbee安全机制说明，z-stack协议栈的研究，准备从门锁开始传输电池电量数据构建一整套回路，准备开始写论文框架 |   
| 2016/11/23    | 论文    	 | 编写论文，写出第一章绪论第一小节研究背景和意义。研究了z-stack协议栈通信的点播，组播和广播，仍然有很多不清楚的地方需要深入研究。 |  
| 2016/11/24    | 论文   	 | 编写论文，写出第一章绪论第二小节国内外研究现状，参考了大量的国外文献。|  
| 2016/11/25    | 论文   	 | 编写论文，写出第二章绪论第一二三小节，参考了大量的国外文献。|  
| 2016/11/28    | 论文    	 | 编写论文，写出第三章一二小节。测试了系统移动式设备如手机的访问可行性。|  
| 2016/11/29    | 论文    	 | 编写论文，写出第三章三小节第一小点。|  
| 2016/12/01    | 论文    	 | 编写论文，写出第三章三小节第二三小点以及第四小节，调整章节顺序。|  
| 2016/12/02    | 论文    	 | 编写论文，调整第二章的章节，新增2.4小节，编写2.4小节的一二两小点。|  
| 2016/12/03    | 论文    	 | 编写论文，编写2.4小节第三小节。|  
| 2016/12/05    | 论文    	 | 编写论文，编写2.4小节第4,5小节，新增安全服务第6小节，感觉论文写的有点糅杂，顺便参考论文的质量也参差不齐，论文的口语化偏重，仍然需要大量的查阅别人的论文，之后需要标记写的好的章节以及需要重新修改较多的章节。之前的论文框架写完第二次修改重新审阅。|  
| 2016/12/06    | 论文    	 | 第二章和第三章写完，重新安排时间规划，白天编写门锁和基站以及上位机的通信程序，晚上撰写论文。| 
| 2016/12/07    | zigbee-tcp/http| windows环境运行修复，准备使用z-stack上传数据，建立tcp服务器和客户端的通信机制。| 
| 2016/12/08    | zigbee-ztack	 | Z-Stack协议栈的深入研究，包括函数的作用和数据的传输。| 
| 2016/12/09    | zigbee-ztack   | Z-Stack协议栈的深入研究，包括函数的作用和数据的传输，基本了解的应用层协议的机制，接下来可能会分析如何新建Z-Stack的工程和应用。| 
|               | zigbee-docs    | 编写了PPT,对阶段性工作了做了一个小结，同时整理了一份Z-Stack的分析笔记。| 
| 2016/12/13    | zigbee-ztack   | Z-Stack工程的建立，加入了基站和门锁的应用层程序。 | 
| 2016/12/14    | zigbee-ztack   | 门锁低功耗模式，设计为PM2功耗模式,采用休眠-唤醒-休眠的工作模式。每1s向基站发送data request，获取基站的命令数据。 | 
|               | zigbee-docs    | Z-stack笔记中加入理论书籍中的理论知识点。 | 
|               | 论文           | 根据Z-Stack的协议栈，重新修改了前三章的部分理论知识点，规划第四章基站和门锁的硬件设计。 | 
| 2016/12/15    | zigbee-ztack   | 设置门锁离线定时程序，每隔1s启动离线程序，修改了LED底层驱动，目前只是实现了LED 1s闪烁，后期需要加入RFID读卡程序。 | 
|               | zigbee-docs    | Z-stack笔记中加入理论书籍中的理论知识点。 | 
|               | 论文           | 根据Z-Stack的协议栈，重新修改了前三章的部分理论知识点和结构图，规划第四章基站和门锁的硬件设计。 | 
| 2016/12/16    | zigbee-ztack   | 修改底层按键硬件驱动，测试了按键的轮询扫描模式和中断触发模式成功。 | 
|               | zigbee-docs    | Z-stack笔记中加入理论书籍中的理论知识点，底层硬件硬件按键驱动的修改以及事件触发的流程机制研究。 | 
| 2016/12/17    | zigbee-ztack   | 添加了延时函数和蜂鸣器应用。 |   
| 2016/12/18    | zigbee-ztack   | 添加了i2c驱动程序，添加了电机端口驱动程序，添加了电机设备程序，添加了EEPROM存储和读取程序，可以做到开门电机正反转和蜂鸣器LED提示音效果，配置了锁扣的中断触发初始化程序，可以做到检测开门动作并及时关门处理。 |
|               | zigbee-docs    | Z-stack笔记中加入低功耗说明。 | 
| 2016/12/19    | zigbee-ztack   | 添加了门锁反锁识别，添加了RFID刷卡读写卡程序，可以利用RFID卡开门。 |
|               | 论文  	 | 修改了3.3节，添加了摘要。  | 
| 2016/12/20    | zigbee-ztack   | 修改了EEPROM读取数据的BUG，添加了RFID卡的权限功能，包括普通进出卡，授权卡，删权卡，总卡等，可以对门锁进行离线的授权和删权以及初始化处理，增加了普通卡列表存储，保存在EEPROM中。对Z-Stack中信道的修改和信标帧的请求周期做了测试，并利用Packet Sniffer抓包工具对网络的建立过程进行了深入分析。 |
|               | zigbee-docs  	 | 添加了Packet Sniffer对于网络建立过程的数据帧的分析说明。  | 
| 2016/12/21    | zigbee-ztack   | 改写了基站的LED驱动，增加了基站的串口驱动，实现了基站和门锁之间的广播和点播通信，利用串口助手增加了点对点通信数据丢包率的测试，明天可以根据地形、距离和电池电量进行丢包率测试。 |
|               | zigbee-docs  	 | 增加了基站和门锁各种可能断网和连网的抓包情况说明。  | 
| 2016/12/22    | zigbee-ztack   | 使用两把门锁点对点通信的方式实现和基站的通信，进行了丢包率测试，分别测试了10，15，20，25，30，35，40米平均三次，每次发送100帧数据，每帧数据3s发送一次，丢包率测试情况，正对的测试效果好，侧对的效果略差，误差率一般都在2%以内。 |
|               | zigbee-docs  	 | 增加了修改发射功率的说明。|
| 2016/12/23    | zigbee-ztack   | 基站添加了关联表用来关联连接的门锁设备信息，基站实现了通过网络地址点对点发送数据给门锁，基站添加了串口驱动程序，实现了TCP客户端和上位机Node的Tcp服务端通信。 |
|               | zigbee-docs  	 | 增加了基站和上位机之间的通信协议文档，3.0版本，后期可能还需要修改。|
| 2016/12/26    | zigbee-ztack   | 编写了和上位机通信的协议程序。|
|               | zigbee-http  	 | 添加了获取门锁关联列表页面。|
| 2016/12/27    | zigbee-ztack   | 获取关联列表 |
|               | zigbee-http  	 | redis发布，socket通信 |
|               | zigbee-tcp  	 | redis订阅，发送数据给基站 |
| 2016/12/28    | zigbee-ztack   | 反馈基站的门锁关联列表数据给tcp服务器，通过接接收上位机的命令发送点播信息给门锁，门锁开门并反馈开门命令信息 |
|               | zigbee-http  	 | 可以发送命令给基站，并从基站获取数据显示到网页客户端，通过socket和redis实现，添加了开门命令，可以远程进行开门 |
|               | zigbee-tcp  	 | 成功解析基站发送的数据帧，并通过redis发布给http服务器，实现了远程开门和获取基站列表数据 |
|               | zigbee-docs  	 | 修改了串口通信协议，升级至3.1版本 |
| 2016/12/29    | zigbee-ztack   | 添加Adc配置，检测电池电量，上传给上位机，开门时上传电池电量和信号强度 |
|               | zigbee-http  	 | 远程开门得到反馈或者超时触发开门失败，更新了协议的实现，获取关联地址时获取了MAC地址和网络地址，获取基站下每一把门锁的信号强度，电池电量以及MAC地址等 |
|               | zigbee-tcp  	 | 优化基站的数据结构 |
|               | zigbee-docs  	 | 修改了通信协议的命令传输数据|
| 2016/12/30    | zigbee-http    | 添加了操作员账号注册功能，添加了操作的删除和修改功能 |
| 2016/12/31    | zigbee-http    | 添加了基站的连接和断开状态数据库存储，添加了基站断开的检测功能，优化了获取门锁列表的数据库处理 |
|    		| zigbee-tcp	 | tcp不应该进行mongodb数据存储，交给http服务器处理 |
|  		| zigbee-docs    | 添加了客户端功能说明 |
| 2017/01/01    | zigbee-http    | 添加了tcp通讯程序存活的判断和客户端显示 |
|    		| zigbee-tcp	 | 1s产生一个时间戳，用于记录tcp进程的心跳，存储在redis中|
|  		| zigbee-docs    | 添加了客户端功能说明 |
| 2017/01/04    | zigbee-zstack  | 添加了门锁的低功耗，低功耗电流仍需测试。 |
|    		| 论文		 | 修改之前的错误点，重新审视论文的结构，考虑要不要增加一大章节，第三章之前插入关键技术章节? |
| 2017/01/09    | 论文	         | 重写了摘要，写了本文的主要工作，考虑在理论中加入更多需要的知识 |
| 2017/01/10    | 论文	         | 完善了摘要和1.3本文主要工作，修改了系统总体设计的内容，接下来撰写第四章硬件设计部分 |
| 2017/01/11    | 电路	         | 使用Altium Designer15重新排版了门锁和基站控制器的电路 |
|  		| zigbee-docs    | 添加了门锁和基站控制器电路PDF |
| 2017/01/12    | 论文	         | 重新规划了章节要点，需要突出RFID,Zigbee以及Node.js的理论部分。 |
| 2017/01/13    | 论文	         | 查看天线的设计以及路径损耗算法 |
| 2017/01/14    | 论文	         | 撰写路径损耗算法 |
| 2017/01/15    | 论文	         | 撰写路径损耗算法 |
| 2017/01/16    | 论文	         | 撰写路径损耗算法撰写完成，写第四章第2小节 |
| 2017/01/17    | 论文	         | 撰写第四章第1小节和第3小节 |
| 2017/01/18    | 论文	         | 撰写第四章第3小节 |
| 2017/01/19    | 论文	         | 撰写第四章第3小节 |
| 2017/02/09    | 论文	         | 第四章完成，构思第五章Z-Stack下位机软件设计 |
| 2017/02/16    | 论文	         | 第五章5.3小节 |
| 2017/02/20    | 论文	         | 第五章完成 |
| 2017/02/21    | 论文	         | 第六章6.2小节 |
| 2017/02/22    | 论文	         | 第七章7.3小节 |
| 2017/02/23    | 论文	         | 第七章7.4小节 |
| 2017/02/24    | zigbee-http 	 | 响应式样式设计 |
|               | 论文    	 | 页面测试编写 |
| 2017/02/25    | 论文  	 | 响应式样式设计、第7章完成 |
| 2017/02/26    | 论文  	 | 论文初稿完成 |
| 2017/02/27    | 硬件电路 	 | 使用示波器探头测试了门锁控制器在刷卡以及通信时的电流脉冲以及脉宽图，需要修改7.3小节 |
|               | 论文  	 | 论文格式修改和排版 |
| 2017/03/01    | 论文   	 | 英文摘要的编写，低功耗测试章节的修改 |
| 2017/03/02    | 论文   	 | 修改论文格式 |
| 2017/03/03    | 论文   	 | 论文初稿完成 |
| 2017/03/12    | 论文   	 | 论文章节重新调整，去掉双线地面反射模型，该模型并不是室内模型，增加了室内模型。 |


## 论文目录进度

```javascript

.
├── 基于Zigbee的无线门锁系统设计与实现 
├── 摘要
├── 第一章 绪论	
│   ├── 1.1 研究背景与意义   
│   ├── 1.2 国内外研究现状
│   │   ├── 1.2.1 公租房国内外发展状况
│   │   ├── 1.2.2 智能锁国内外发展现状
│   │   └── 1.2.3 Zigbee无线网络研究现状   
│   ├── 1.3 本文的主要工作
│   └── 1.4 本文的组织机构(未完成)		
├── 第二章 Zigbee概述
│   ├── 2.1 Zigbee网络特点
│   ├── 2.2 Zigbee网络设备类型和拓扑结构
│   ├── 2.3 Zigbee网络协议栈
│   ├── 2.4 Zigbee网络安全服务
│   ├── 2.5 Zigbee网络路径损耗
│   │   ├── 2.5.1 自由空间模型
│   │   ├── 2.5.2 对数正态阴影模型
│   │   └── 2.5.3 同楼层分隔损耗模型
│   └── 2.6 本章小结
├── 第三章 系统总体设计
│   ├── 3.1 需求分析
│   │   ├── 3.1.1 无线门锁需求分析
│   │   └── 3.1.2 管理系统需求分析
│   ├── 3.2 系统整体框架
│   ├── 3.3 系统硬件总体设计
│   │   ├── 3.3.1 系统硬件拓扑设计
│   │   ├── 3.3.2 门锁控制器硬件结构
│   │   └── 3.3.3 基站控制器硬件结构
│   ├── 3.3 系统软件层级设计
│   └── 3.4 本章小节
├── 第四章 系统的硬件设计
│   ├── 4.1 门锁控制器
│   │   ├── 4.1.1 CC2530模块
│   │   ├── 4.1.2 电源模块
│   │   ├── 4.1.3 MFRC523驱动模块
│   │   ├── 4.1.4 电机驱动模块
│   │   ├── 4.1.5 LED和蜂鸣器模块
│   │   └── 4.1.6 EEPROM和RTC模块
│   ├── 4.2 基站控制器
│   │   ├── 4.2.1 电源模块
│   │   ├── 4.2.2 LED模块
│   │   └── 4.2.3 以太网模块
│   └── 4.3 本章小节
├── 第五章 Z-Stack协议栈
│   ├── 5.1 协议栈简介
│   │   ├── 5.1.1 Z-Stack目录结构
│   │   ├── 5.1.2 OSAL操作系统
│   │   ├── 5.1.3 ZigBee组网过程
│   │   └── 5.1.4 ZigBee网络安全性
│   ├── 5.2 门锁控制器的程序设计
│   │   ├── 5.2.1 门锁应用程序文件结构
│   │   ├── 5.2.2 门锁应用程序设计
│   │   └── 5.2.3 门锁读卡驱动程序设计
│   ├── 5.3 门锁控制器的低功耗设计
│   ├── 5.4 基站控制器的程序设计
│   └── 5.5 本章小节
├── 第六章 系统软件设计
│   ├── 6.1 Node.js简介
│   │   ├── 6.1.1 Node.js组件构成
│   │   ├── 6.1.2 Node.js特点
│   │   └── 6.1.3 模块和包管理
│   ├── 6.2 软件的整体架构设计
│   ├── 6.3 通讯软件设计
│   ├── 6.4 管理软件设计
│   └── 6.5 本章小节
├── 第七章 系统实现与测试
│   ├── 7.1 ZigBee组网测试
│   ├── 7.2 ZigBee通信距离和丢包率测试
│   ├── 7.3 门锁控制器低功耗测试
│   ├── 7.4 网页测试
│   │   ├── 7.4.1 登录页
│   │   ├── 7.4.2 主页
│   │   ├── 7.4.3 账号管理
│   │   ├── 7.4.4 门锁列表
│   │   └── 7.4.5 租户设置
│   └── 7.5 本章小节
├── 第八章 总结与展望
│   ├── 8.1 总结
│   └── 8.2 展望
├── 参考文献
├── 附录
├── 致献
└── 攻读学位期间参加的科研项目和成果

```
